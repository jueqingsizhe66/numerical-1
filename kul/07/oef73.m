M = genmatc(6)
% M =
% 
%  Columns 1 through 4:
% 
%      1.064290529263619     0.629507128874299     0.518709313554065     0.320671820181816
%      0.998192254320952     1.603770986955114     1.032816010722424     0.951952463875498
%      0.705010911391316     0.963039101890238     0.637985055797548     0.957532069158373
%      0.481465913131944     0.765199062249375     0.493659012388385     1.487750465129203
%      0.486870775422871     0.967097444653754     0.603416955220278     0.646082682961426
%      0.702782282450332     0.769138630710078     0.533074124964074     1.150332803462191
% 
%  Columns 5 through 7:
% 
%      0.330425036358779     0.518729033083564    70.129653813739878
%      0.648167450148843     0.652020749699885   135.172822432706710
%      0.632108702165837     1.040674485846947   103.755112035658073
%      0.690623892802580     1.190933136585246    95.236805075390677
%      2.344359916459704     0.751429202406441   109.331150143794460
%      1.035167593005636     2.527284501550422   137.068601414158081

A = M(:,1:6)
% A =
% 
%  Columns 1 through 4:
% 
%    1.064290529263619   0.629507128874299   0.518709313554065   0.320671820181816
%    0.998192254320952   1.603770986955114   1.032816010722424   0.951952463875498
%    0.705010911391316   0.963039101890238   0.637985055797548   0.957532069158373
%    0.481465913131944   0.765199062249375   0.493659012388385   1.487750465129203
%    0.486870775422871   0.967097444653754   0.603416955220278   0.646082682961426
%    0.702782282450332   0.769138630710078   0.533074124964074   1.150332803462191
% 
%  Columns 5 and 6:
% 
%    0.330425036358779   0.518729033083564
%    0.648167450148843   0.652020749699885
%    0.632108702165837   1.040674485846947
%    0.690623892802580   1.190933136585246
%    2.344359916459704   0.751429202406441
%    1.035167593005636   2.527284501550422

K = norm(A) * norm(inverse(A))
% K =  58454768901.1612

G1 = gauss2(M)
% G1 =
% 
%  Columns 1 through 4:
% 
%    1.06429052926362e+00   6.29507128874299e-01   5.18709313554065e-01   3.20671820181816e-01
%    9.37894519282812e-01   1.01335970093445e+00   5.46321388439116e-01   6.51196121238529e-01
%    6.62423362800299e-01   5.38840129690420e-01   1.98046024024734e-10   3.94220961256174e-01
%    4.52382032813042e-01   4.74087678023812e-01   9.28543759530003e-01   6.67908824743069e-01
%    4.57460403936635e-01   6.70169593848745e-01   5.80750796035519e-01  -2.48488938057678e-01
%    6.60329358503815e-01   3.48796771571832e-01   8.42018762893533e-01   5.68202157600700e-01
% 
%  Columns 5 through 8:
% 
%    3.30425036358779e-01   5.18729033083564e-01   7.01296538137399e+01   1.00000000000000e+00
%    3.38263619514121e-01   1.65507632577937e-01   6.93986044815991e+01   2.00000000000000e+00
%    2.30957425819104e-01   6.07874101166535e-01   1.99048378851407e+01   3.00000000000000e+00
%    1.66324852765450e-01   3.13366609677571e-01   1.21278734631781e+01   4.00000000000000e+00
%    1.87371073049418e+00   1.28057794414424e-01   2.21946677541313e+01   5.00000000000000e+00
%    2.18825856862735e-01   1.40910462499460e+00   3.80458248748542e+01   6.00000000000000e+00

x1 = asubst(G1)
% x1 =
% 
%     4.00000302264467
%    27.00000967116192
%    58.99998206117141
%     3.00000000000000
%    10.00000000000000
%    27.00000000000000

exact = round(x1)
% exact =
% 
%     4
%    27
%    59
%     3
%    10
%    27

d1 = exact - x1
% d1 =
% 
%   -3.02264466967017e-06
%   -9.67116191930018e-06
%    1.79388285914683e-05
%    3.99680288865056e-15
%   -1.77635683940025e-15
%   -3.55271367880050e-15

norm(d1)/norm(exact)
% ans =  2.89518491178541e-07

A = M(:,1:6)
% A =
% 
%  Columns 1 through 4:
% 
%    1.064290529263619   0.629507128874299   0.518709313554065   0.320671820181816
%    0.998192254320952   1.603770986955114   1.032816010722424   0.951952463875498
%    0.705010911391316   0.963039101890238   0.637985055797548   0.957532069158373
%    0.481465913131944   0.765199062249375   0.493659012388385   1.487750465129203
%    0.486870775422871   0.967097444653754   0.603416955220278   0.646082682961426
%    0.702782282450332   0.769138630710078   0.533074124964074   1.150332803462191
% 
%  Columns 5 and 6:
% 
%    0.330425036358779   0.518729033083564
%    0.648167450148843   0.652020749699885
%    0.632108702165837   1.040674485846947
%    0.690623892802580   1.190933136585246
%    2.344359916459704   0.751429202406441
%    1.035167593005636   2.527284501550422

b = M(:,7)
% b =
% 
%     70.1296538137399
%    135.1728224327067
%    103.7551120356581
%     95.2368050753907
%    109.3311501437945
%    137.0686014141581

R1 = A*x1-b
% R1 =
% 
%    0.00000000000000e+00
%   -2.84217094304040e-14
%    0.00000000000000e+00
%   -1.42108547152020e-14
%    0.00000000000000e+00
%    0.00000000000000e+00

[Q,R] = qr(M)
% Q =
% 
%  Columns 1 through 4:
% 
%    0.5617972893700010  -0.7386500206313695  -0.1913065575029835  -0.0698386359005124
%    0.5269065986480642   0.4509746464801752  -0.6380733522338196   0.2068862882156111
%    0.3721476496365686   0.1269996115586117   0.4373189888815692  -0.4974983662646376
%    0.2541469997940577   0.2080859983930713   0.4492362627095293   0.6665289986851631
%    0.2570000149257075   0.4286036394093896   0.0762083434092788  -0.4760648097960063
%    0.3709712436988752  -0.0888158289670526   0.3967308519016941   0.1841667587638585
% 
%  Columns 5 and 6:
% 
%    0.1524184427910804  -0.2721634379685345
%   -0.2273326714830569   0.1318014488806871
%   -0.6284306334881377  -0.1081648831888424
%    0.0622148245526499  -0.4921023364635142
%    0.6984893271789064  -0.1729657703104187
%    0.1959729294832792   0.7904264240895027
% 
% R =
% 
%  Columns 1 through 4:
% 
%      1.894438704852267     2.285431070702106     1.551326991122429     2.008976870246812
%      0.000000000000000     0.885997202205087     0.477657855660452     0.798374048752343
%      0.000000000000000     0.000000000000000     0.000000000244145     0.923945697367473
%      0.000000000000000     0.000000000000000     0.000000000000000     0.594084651416190
%      0.000000000000000     0.000000000000000     0.000000000000000     0.000000000000000
%      0.000000000000000     0.000000000000000     0.000000000000000     0.000000000000000
% 
%  Columns 5 through 7:
% 
%      1.924431297381814     2.455598438694467   252.385087633898451
%      1.185087273040610     0.388469805180744    76.838417560047219
%      0.699238287713688     1.534760642241643    51.202757324168182
%     -0.668555468136152     0.482437233985306     8.122504590490294
%      1.389119010098039     0.371084847730291    23.910480989698250
%      0.000000000000000     1.113793709597283    30.072430159126618

x2 = asubst(R)
% x2 =
% 
%     3.99998332353427
%    26.99994664248755
%    59.00009897169319
%     3.00000000000001
%    10.00000000000001
%    26.99999999999997

d2 = exact - x2
% d2 =
% 
%    1.66764657341112e-05
%    5.33575124457286e-05
%   -9.89716931911744e-05
%   -6.21724893790088e-15
%   -5.32907051820075e-15
%    3.19744231092045e-14

norm(d2)/norm(exact)
% ans =  1.59732477134089e-06

R2 = A*x2-b
% R2 =
% 
%    1.42108547152020e-14
%    0.00000000000000e+00
%    0.00000000000000e+00
%   -1.42108547152020e-14
%    0.00000000000000e+00
%    0.00000000000000e+00


